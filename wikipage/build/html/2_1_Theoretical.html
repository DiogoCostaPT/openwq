<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Theoretical Foundation &mdash; OpenWQ 0.0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example of Case Studies" href="2_2_Example.html" />
    <link rel="prev" title="Documentation" href="2_0_Documentation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            OpenWQ
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1_0_Home.html">Home</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="2_0_Documentation.html">Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Theoretical Foundation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#conservation-equations">Conservation Equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#biogeochemistry-reaction-networks">Biogeochemistry: Reaction networks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="2_2_Example.html">Example of Case Studies</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_3_Software.html">Software Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="3_0_Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_3_base_Hydro_models.html">Coupling OpenWQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_1_OpenWQ_IO.html">OpenWQ I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_0_Developer.html">Join us!</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_0_Contact.html">Contact</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">OpenWQ</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="2_0_Documentation.html">Documentation</a></li>
      <li class="breadcrumb-item active">Theoretical Foundation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/2_1_Theoretical.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="theoretical-foundation">
<h1>Theoretical Foundation<a class="headerlink" href="#theoretical-foundation" title="Permalink to this heading"></a></h1>
<section id="conservation-equations">
<h2>Conservation Equations<a class="headerlink" href="#conservation-equations" title="Permalink to this heading"></a></h2>
<p>There are two options available for computing the conservative transport of solutes (dissolved in water) or fully suspended sediments.
The first option accounts for transport through both advection and dispersion processes. It solves the hyperbolic-parabolic advection-dispersion PDE, which takes 1D-3D forms depending on the characteristics of the host hydro-model:</p>
<div class="math notranslate nohighlight">
\begin{equation}
\begin{split}
\dfrac{\partial (h \cdot c_s)}{\partial t} + \nabla( h \cdot \vec{v} \cdot c_s) = \nabla (h \cdot D \cdot \nabla c_s) + S  \\
\text{extended up to 3D} \rightarrow \frac{\partial{(h \cdot c_s)}}{\partial t}+\frac{\partial{(h \cdot u_x \cdot c_s)}}{\partial x}+\frac{\partial{(h \cdot u_y \cdot c_s)}}{\partial y} + \frac{\partial{(h \cdot u_z \cdot c_s)}}{\partial z} = \\ \frac{\partial}{\partial x}\Bigl( h \cdot E_x \frac{\partial c_s}{\partial x} \Bigr)+
\frac{\partial}{\partial y}\Bigl( h \cdot E_y \frac{\partial c_s}{\partial y} \Bigr) +
\frac{\partial}{\partial z}\Bigl( h \cdot E_z \frac{\partial c_s}{\partial z} \Bigr) + S
\end{split}
\label{ADE_option1}
\end{equation}</div><p>The second option only accounts for transport through advection:</p>
<div class="math notranslate nohighlight">
\begin{equation}
\begin{split}
\dfrac{\partial (h \cdot c_s)}{\partial t} + \nabla( h \cdot \vec{v} \cdot c_s) = S  \\
\text{extended up to 3D} \rightarrow \frac{\partial{(h \cdot c_s)}}{\partial t}+\frac{\partial{(h \cdot u_x \cdot c_s)}}{\partial x}+\frac{\partial{(h \cdot u_y \cdot c_s)}}{\partial y} + \\ \frac{\partial{(h \cdot u_z \cdot c_s)}}{\partial z} = S
\end{split}
\label{AE_option2}
\end{equation}</div><p>where <span class="math notranslate nohighlight">\(c_s\)</span> is the concentration of a given dissolved substance <span class="math notranslate nohighlight">\([ML^{-3}]\)</span>; <span class="math notranslate nohighlight">\(u\)</span> is the velocity in the x, y and z direction <span class="math notranslate nohighlight">\([LT^{-1}]\)</span> <span class="math notranslate nohighlight">\(E\)</span> is the horizontal diffusivity <span class="math notranslate nohighlight">\([L^2T^{-1}]\)</span>; and <span class="math notranslate nohighlight">\(S\)</span> is a source term <span class="math notranslate nohighlight">\([ML^{-2}T^{-1}]\)</span> that is linked to the chemistry modules. The <span class="math notranslate nohighlight">\(E\)</span> term accounts for the combined effect of different mixing phenomena:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
E=E^{turb}+E^{tsd}+E^{sgt}+E_d
\label{SW_eq5}
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(E^{turb}\)</span> is the turbulent or eddy diffusivity, which is a complex phenomena with multifractal behaviour dominated by friction forcess, <span class="math notranslate nohighlight">\(E^{tsd}\)</span> is the so-called Taylor-shear dispersion that arises from the unresolved vertical variation of the horizontal flow, <span class="math notranslate nohighlight">\(E^{sgt}\)</span> accounts for the sub-grid eddy viscosity and diffusivity arising from unresolved mixing occurring at sub-grid scale, and <span class="math notranslate nohighlight">\(E\)</span> is the background molecular diffusion resulting from the probabilistic Brownian motion concept occurring at particle scales.
<span class="math notranslate nohighlight">\(E\)</span> is approximated to the dominant turbulent dispersion based on the eddy viscosity concept: <span class="math notranslate nohighlight">\(E^{turb} = \nu_t / \sigma\)</span>, where <span class="math notranslate nohighlight">\(\sigma\)</span> is the Prandtl-Schmidt number. Turbulent viscosity (<span class="math notranslate nohighlight">\(\nu_t\)</span>) depends on shear velocity (<span class="math notranslate nohighlight">\(u^*\)</span>) and on a turbulent length scale (<span class="math notranslate nohighlight">\(l_t=0.07h\)</span>).
In this model, this relationship is approximated by an algebraic expression: <span class="math notranslate nohighlight">\(\nu_t \approx k u^* l_t\)</span>, where <span class="math notranslate nohighlight">\(k\)</span> is a user-defined scaling factor to account for sub-grid scale eddies.</p>
</section>
<section id="biogeochemistry-reaction-networks">
<h2>Biogeochemistry: Reaction networks<a class="headerlink" href="#biogeochemistry-reaction-networks" title="Permalink to this heading"></a></h2>
<p>These expressions are flexible and defined by the user.
They are powered by the comprehensive C++ Mathematical Expression Toolkit Library (<code class="docutils literal notranslate"><span class="pre">ExprTk</span></code>) developed by <a class="reference external" href="http://www.partow.net/programming/exprtk/index.html">Arash Partow (1999-2020)</a>.
The implementation of <code class="docutils literal notranslate"><span class="pre">ExprTk</span></code> in OpenWQ is simple to use and provides an extremely efficient run-time mathematical expression parser and evaluation engine.</p>
<p><code class="docutils literal notranslate"><span class="pre">ExprTk</span></code> supports numerous forms of functional, logical and vector processing semantics and is very easily extendible. In computational biogeochemistry, reaction kinetics usually take the general form of <span class="math notranslate nohighlight">\(1^{st}\)</span>, <span class="math notranslate nohighlight">\(2^{nd}\)</span> or <span class="math notranslate nohighlight">\(3^{rd}\)</span>-multispecies <a class="reference external" href="https://en.wikipedia.org/wiki/Chemical_kinetics">reaction kinetics</a>.</p>
<div class="math notranslate nohighlight">
\begin{equation}
\frac{\partial{c_a}}{\partial t} = - k \cdot B \cdot c_a
\label{1storder_eq}
\end{equation}</div><div class="math notranslate nohighlight">
\begin{equation}
\frac{\partial{c_a}}{\partial t} = - k \cdot B \cdot c_a^2
\label{2ndorder_eq}
\end{equation}</div><div class="math notranslate nohighlight">
\begin{equation}
\frac{\partial{c_a}}{\partial t} = - k \cdot B \cdot c_a^2 * c_b
\label{3rdorder_eq}
\end{equation}</div><p>where <span class="math notranslate nohighlight">\(c_a\)</span> and <span class="math notranslate nohighlight">\(c_b\)</span> <span class="math notranslate nohighlight">\([ML^{-3}]\)</span> are the concentrations of chemical species <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, parameter/variable <span class="math notranslate nohighlight">\(B\)</span> represents weather/hydrological dependencies (such as soil moisture and temperature) and <span class="math notranslate nohighlight">\(k\)</span> is the reaction rate <span class="math notranslate nohighlight">\([ML^{-3}T^{-1}]\)</span>. The reaction rate <span class="math notranslate nohighlight">\(k\)</span> can be provided as the reaction rate (usually using standard maximum at a reference temperature, often <span class="math notranslate nohighlight">\(20^oC\)</span>) or using expressions that can include relationships with the hydrological/weather dependency variables/parameters.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="2_0_Documentation.html" class="btn btn-neutral float-left" title="Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="2_2_Example.html" class="btn btn-neutral float-right" title="Example of Case Studies" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Diogo Costa.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>